!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).VueStore=t()}(this,function(){"use strict";var e;function t(e,t,n){n.name!==t&&Object.defineProperty(n,"name",{value:t}),e[t]=n}function n(e){throw Error("[vue-store] error: "+e)}function o(e){console.warn("[vue-store] warn: "+e)}function r(e){return!!e&&/[A-Z]/.test(e[0])}function u(e,t,n){void 0===t&&(t=[]),"function"==typeof e&&(e=e());var o={state:{},getters:{},mutations:{},actions:{},subModules:{},routes:t.slice()};return Object.keys(e).forEach(function(i){if(r(i))e[i]&&(o.subModules[i]=u(e[i],t.concat(i),n?n[i]:null));else{var a=Object.getOwnPropertyDescriptor(e,i).get;"function"==typeof a?o.getters[i]=a:"function"==typeof e[i]?o["$"===i[0]?"actions":"mutations"][i]=e[i]:o.state[i]=n?n[i]:e[i]}}),o}var i="__VUE_STORE_META__";return{install:function(t){e&&e===t&&o("Do not install the plugin again."),(e=t).mixin({beforeCreate:function(){var e=this.$options;e.store?this.$store=e.store:e.parent&&e.parent.$store&&(this.$store=e.parent.$store)}})},createStore:function(a,s){e||n("Please install vue-store plugin first.");var _=!1,c=!1,f="",v=new e,l=!!s&&s.strict,p={addModule:function(e,t,n){var o=e.split(".");n=n||{preserveState:!0};var r=o.pop(),a=y;if(o.forEach(function(e){a=a[e]}),a[r]&&a[r].__vue__)return a[r];var s=u(t);if(a[r]&&(n.preserveState||!("preserveState"in n))){var _=a[r].__vue__;s.state=Object.assign({},_?_[i].state:a[r])}return a[r]=d(s),a[r].__vue__[i].dynamic=!0,a.__vue__[i].state[r]=a[r].__vue__[i].state,a.__vue__[i].stateGetters[r]=a[r].__vue__[i].stateGetters,a[r]},removeModule:function(e){var t=e.split("."),n=t.pop(),o=y;t.forEach(function(e){o=o[e]}),o[n].__vue__.$destroy(),delete o[n],delete o.__vue__[i].state[n],delete o.__vue__[i].stateGetters[n]},subscribe:function(e){var t=function(t,n){e(t,n)};return v.$on(f=f||"vuestore-mutation-action-subscribe-event",t),function(){v.$off(f,t)}},replaceState:function(e,t,n){var o=this;t=t||y,Object.keys(e).forEach(function(u){if(r(u)){var i=(n||[]).concat(u);t[u]&&t[u].__vue__?o.replaceState(e[u],t[u],i):Object.assign(t[u],e[u])}else c=!0,t.__vue__[u]=e[u],c=!1})},watch:function(e,t,n){return v.$watch(e,t,n)},getState:function(){return o("Only call getState in development mode."),JSON.parse(JSON.stringify(y.__vue__[i].state))},hotUpdate:function(e,t){"string"!=typeof e&&(t=e,e="");var n=y,o=[];e&&(o=e.split(".")).forEach(function(e){n=n[e]});var r=u(t,o);n.__vue__[i].getters=r.getters,n.__vue__[i].mutations=r.mutations,n.__vue__[i].actions=r.actions}};function d(o){var r=o.state,u=o.getters,a=o.mutations,s=o.actions,y=o.subModules,m=o.routes,b=m.length?{}:Object.create(p),h={},O=Object.create(h),g={data:{},computed:{},methods:{}};return Object.keys(r).forEach(function(e){g.data[e]=r[e];var t={get:function(){return b.__vue__[e]},set:function(t){b.__vue__[e]=t},enumerable:!0};Object.defineProperty(b,e,t),Object.defineProperty(h,e,t)}),Object.keys(u).forEach(function(e){g.computed[e]=function(){return b.__vue__[i].getters[e].call(O)};var t={get:function(){return b.__vue__[e]},enumerable:!0};Object.defineProperty(b,e,t),Object.defineProperty(O,e,t)}),Object.keys(a).forEach(function(e){g.methods[e]=function(t){b.__vue__[i].mutations[e].call(h,t)},t(b,e,function(t){_=!0,b.__vue__[e](t),_=!1,f&&v.$emit(f,{type:m.join("."),payload:t},h)})}),Object.keys(s).forEach(function(e){g.methods[e]=function(t){return b.__vue__[i].actions[e].call(b,t)},t(b,e,function(t){var n=b.__vue__[e](t);return Promise.resolve(n).then(function(e){return f&&v.$emit(f,{actionType:m.join("."),payload:t},h),e})})}),Object.keys(y).forEach(function(e){b[e]=d(y[e]),h[e]=b[e].__vue__[i].state,O[e]=b[e].__vue__[i].stateGetters}),Object.defineProperty(b,"__vue__",{value:new e(g)}),Object.defineProperty(b.__vue__,i,{value:{state:h,stateGetters:O,getters:u,mutations:a,actions:s}}),l&&b.__vue__.$watch(function(){return h},function(){if(!_&&!c)try{n("Only mutation(pure function) could change store.")}catch(e){setTimeout(function(){throw e},0)}},{deep:!0,sync:!0}),b}l&&o("Only use strict option in development mode.");var y=d(u(a));return s&&Array.isArray(s.plugins)&&s.plugins.forEach(function(e){"function"==typeof e&&e(y)}),y}}});
