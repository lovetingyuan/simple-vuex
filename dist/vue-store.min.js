!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).VueStore=t()}(this,(function(){"use strict";function e(){for(var e=0,t=0,n=arguments.length;n>t;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;n>t;t++)for(var u=arguments[t],a=0,i=u.length;i>a;a++,o++)r[o]=u[a];return r}var t;function n(e,t,n){n.name!==t&&Object.defineProperty(n,"name",{value:t}),e[t]=n}function r(e){throw Error("[vue-store] error: "+e)}function o(e){console.warn("[vue-store] warn: "+e)}function u(e){return!!e&&/[A-Z]/.test(e[0])}function a(t,n,r){void 0===n&&(n=[]),"function"==typeof t&&(t=t());var o={state:{},getters:{},mutations:{},actions:{},subModules:{},routes:e(n)};return Object.keys(t).forEach((function(e){if(u(e))t[e]&&(o.subModules[e]=a(t[e],n.concat(e),r?r[e]:null));else{var i=Object.getOwnPropertyDescriptor(t,e).get;"function"==typeof i?o.getters[e]=i:"function"==typeof t[e]?o["$"===e[0]?"actions":"mutations"][e]=t[e]:o.state[e]=r?r[e]:t[e]}})),o}var i="__VUE_STORE_META__";return{install:function(e){t&&t===e&&o("Do not install the plugin again."),(t=e).mixin({beforeCreate:function(){var e=this.$options;e.store?this.$store=e.store:e.parent&&e.parent.$store&&(this.$store=e.parent.$store)}})},createStore:function(e,s){t||r("Please install vue-store plugin first.");var c=!1,_=!1,f="",v=new t,l=!!s&&s.strict,p={addModule:function(e,t,n){var r=e.split(".");n=n||{preserveState:!0};var o=r.pop(),u=y;if(r.forEach((function(e){u=u[e]})),u[o]&&u[o].__vue__)return u[o];var s=a(t);if(u[o]&&(n.preserveState||!("preserveState"in n))){var c=u[o].__vue__;s.state=Object.assign({},c?c[i].state:u[o])}return u[o]=d(s),u[o].__vue__[i].dynamic=!0,u.__vue__[i].state[o]=u[o].__vue__[i].state,u.__vue__[i].stateGetters[o]=u[o].__vue__[i].stateGetters,u[o]},removeModule:function(e){var t=e.split("."),n=t.pop(),r=y;t.forEach((function(e){r=r[e]})),r[n].__vue__.$destroy(),delete r[n],delete r.__vue__[i].state[n],delete r.__vue__[i].stateGetters[n]},subscribe:function(e){var t=function(t,n){e(t,n)};return v.$on(f=f||"vuestore-mutation-action-subscribe-event",t),function(){v.$off(f,t)}},replaceState:function(e,t,n){var r=this;t=t||y,Object.keys(e).forEach((function(o){if(u(o)){var a=(n||[]).concat(o);t[o]?t[o].__vue__?r.replaceState(e[o],t[o],a):Object.assign(t[o],e[o]):t[o]=Object.assign({},e[o])}else _=!0,t.__vue__[o]=e[o],_=!1}))},watch:function(e,t,n){return v.$watch(e,t,n)},getState:function(){return o("Only call getState in development mode."),JSON.parse(JSON.stringify(y.__vue__[i].state))},hotUpdate:function(e,t){"string"!=typeof e&&(t=e,e="");var n=y,r=[];e&&(r=e.split(".")).forEach((function(e){n=n[e]}));var o=a(t,r);n.__vue__[i].getters=o.getters,n.__vue__[i].mutations=o.mutations,n.__vue__[i].actions=o.actions}};function d(e){var o=e.state,u=e.getters,a=e.mutations,s=e.actions,y=e.subModules,h=e.routes,m=h.length?{}:Object.create(p),b={},g=Object.create(b),O={data:{},computed:{},methods:{}};return Object.keys(o).forEach((function(e){O.data[e]=o[e];var t={get:function(){return m.__vue__[e]},set:function(t){m.__vue__[e]=t},enumerable:!0};Object.defineProperty(m,e,t),Object.defineProperty(b,e,t)})),Object.keys(u).forEach((function(e){O.computed[e]=function(){return m.__vue__[i].getters[e].call(g)};var t={get:function(){return m.__vue__[e]},enumerable:!0};Object.defineProperty(m,e,t),Object.defineProperty(g,e,t)})),Object.keys(a).forEach((function(e){O.methods[e]=function(t){m.__vue__[i].mutations[e].call(b,t)},n(m,e,(function(t){c=!0,m.__vue__[e](t),c=!1,f&&v.$emit(f,{type:h.join("."),payload:t},b)}))})),Object.keys(s).forEach((function(e){O.methods[e]=function(t){return m.__vue__[i].actions[e].call(m,t)},n(m,e,(function(t){var n=m.__vue__[e](t);return Promise.resolve(n).then((function(e){return f&&v.$emit(f,{actionType:h.join("."),payload:t},b),e}))}))})),Object.keys(y).forEach((function(e){m[e]=d(y[e]),b[e]=m[e].__vue__[i].state,g[e]=m[e].__vue__[i].stateGetters})),Object.defineProperty(m,"__vue__",{value:new t(O)}),Object.defineProperty(m.__vue__,i,{value:{state:b,stateGetters:g,getters:u,mutations:a,actions:s}}),l&&m.__vue__.$watch((function(){return b}),(function(){if(!c&&!_)try{r("Only mutation(pure function) could change store.")}catch(e){setTimeout((function(){throw e}),0)}}),{deep:!0,sync:!0}),m}l&&o("Only use strict option in development mode.");var y=d(a(e));return s&&Array.isArray(s.plugins)&&s.plugins.forEach((function(e){"function"==typeof e&&e(y)})),y}}}));
