!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).VueStorePlugin=t()}(this,function(){"use strict";var e,t="vuestore: ";return{install:function(n){e&&e===n&&console.warn(t+"Do not install the plugin again."),(e=n).mixin({beforeCreate:function(){var e=this.$options;e.store?this.$store=e.store:e.parent&&e.parent.$store&&(this.$store=e.parent.$store)}})},createStore:function(n,o){if(!e)throw new Error(t+"Please install VueStorePlugin first.");var r=!1,i=!1,c="",u=new e,a={addModule:function(e,t){var n=e.split("."),o=n.pop(),r=p;n.forEach(function(e){r=r[e]});var i={};return Object.defineProperty(r,o,{value:f(t,n.concat(o),i,{}),enumerable:!0,configurable:!0}),r.__state__[o]=i,r[o]},removeModule:function(e){var n=e.split("."),o=n.pop(),r=p;n.forEach(function(e){r=r[e]});try{var i=r[o].__vue__;delete r.__state__[o],delete r[o],i.$destroy()}catch(n){throw new Error(t+"Only dynamic module can be removed while "+e+" is an initial module.")}},subscribe:function(e){c||(c="vuestore-mutation-action-subscribe-event");var t=function(t,n){e(t,n)};return u.$on(c,t),function(){u.$off(c,t)}},replaceState:function(e,n){void 0===n&&(n=p),i=!0;var o=n.__vue__;Object.keys(e).forEach(function(r){if(/[A-Z]/.test(r[0])){var i=a.replaceState;if(!n[r])throw new Error(t+"Namespace sub module "+r+" does not exist");i(e[r],n[r])}else{"function"!=typeof Object.getOwnPropertyDescriptor(e,r).get&&"function"!=typeof e[r]&&o.$set(o,r,e[r])}}),i=!1},watch:function(e,t,n){var o=e.bind(l);return u.$watch(o,t,n)},getState:function(){return JSON.parse(JSON.stringify(p.__state__))},hotUpdate:function(e,t){var n="string"==typeof e?t:e,o="string"==typeof e?e:"",r=o.split("/"),i=p;r.forEach(function(e){i=i[e]}),Object.keys(i.__module__).forEach(function(e){"function"==typeof i.__module__[e]&&delete i.__module__[e]}),Object.keys(n).forEach(function(e){if(/[A-Z]/.test(e[0])){(0,a.hotUpdate)(o+"/"+e,n[e])}else{var t=Object.getOwnPropertyDescriptor(n,e).get;"function"==typeof t?i.__module__[e]=t:"function"==typeof n[e]&&(i.__module__[e]=n[e])}})}};function f(t,n,o,i){"function"==typeof t&&(t=t());var s={},l=n.length?{}:Object.create(a),p={},_=n.join("/");Object.keys(t).forEach(function(e){if(/[A-Z]/.test(e[0])){if(!t[e])return;var a={},y={},v=f(t[e],n.concat(e),a,y);Object.defineProperty(l,e,{value:v,enumerable:!0,configurable:!1}),o[e]=a,i[e]=y}else{var b=Object.getOwnPropertyDescriptor(t,e).get;if("function"==typeof b){s[e]=b,p.computed=p.computed||{},p.computed[e]=function(){return s[e].call(i)};var m={get:function(){return d[e]},enumerable:!0};Object.defineProperty(i,e,m),Object.defineProperty(l,e,m)}else if("function"==typeof t[e])s[e]=t[e],h=l,O=e,g="$"===e[0]?function(t){return c&&u.$emit(c,{actionType:_?_+"/"+e:e,payload:t},o),s[e].call(l,t)}:function(t){r=!0,c&&u.$emit(c,{type:_?_+"/"+e:e,payload:t},o),s[e].call(o,t),r=!1},h[O]=(j={},j[O]=g,j)[O];else{(p.data=p.data||{})[e]=t[e];m={get:function(){return d[e]},set:function(t){d[e]=t},enumerable:!0};Object.defineProperty(o,e,m),Object.defineProperty(i,e,m),Object.defineProperty(l,e,m)}}var h,O,g,j});var d=new e(p);return Object.defineProperties(l,{__vue__:{value:d},__module__:{value:s},__state__:{value:o}}),l}var s={},l={},p=f(n,[],s,l);return o&&o.strict&&u.$watch(function(){return s},function(){r||i||setTimeout(function(){throw new Error(t+"Only mutation could change state!")})},{deep:!0,sync:!0}),o&&Array.isArray(o.plugins)&&o.plugins.forEach(function(e){"function"==typeof e&&e(p)}),p}}});
