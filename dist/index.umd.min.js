!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).VueStorePlugin=t()}(this,function(){"use strict";var e;function t(e,t,n){n.name!==t&&Object.defineProperty(n,"name",{value:t}),e[t]=n}function n(e){throw new Error("vue-store error: "+e)}function r(e){console.warn("vue-store warn: "+e)}return{install:function(t){e&&e===t&&r("Do not install the plugin again."),(e=t).mixin({beforeCreate:function(){var e=this.$options;e.store?this.$store=e.store:e.parent&&e.parent.$store&&(this.$store=e.parent.$store)}})},createStore:function(o,i){e||n("Please install VueStorePlugin first.");var a=!1,_=!1,c="",u=new e,s=!!i&&i.strict,f={addModule:function(e,t,n){var o=e.split(".");n=n||{preserveState:!0};var i=o.pop(),a=l;o.forEach(function(e){a=a[e]});var _={};return!a[i]||!n.preserveState&&"preserveState"in n||Object.assign(_,a[i].__state__),a[i]&&a[i].__vue__?(r(e+" has been added, do not repeat to add it."),a[i]):(a[i]=p(t,o.concat(i),_),a.__state__[i]=a[i].__state__,a[i])},removeModule:function(e){var t=e.split("."),r=t.pop(),o=l;t.forEach(function(e){o=o[e]});try{var i=o[r].__vue__;delete o.__state__[r],delete o[r],i.$destroy()}catch(t){n(e+" can not be removed as it is not dynamic module.")}},subscribe:function(e){c=c||"vuestore-mutation-action-subscribe-event";var t=function(t,n){e(t,n)};return u.$on(c,t),function(){u.$off(c,t)}},replaceState:function(e,t){var n=this;t=t||l,Object.keys(e).forEach(function(r){/[A-Z]/.test(r[0])?t[r]?n.replaceState(e[r],t[r]):(t[r]={__state__:e[r]},t.__state__[r]=e[r]):(_=!0,t.__vue__[r]=e[r],_=!1)})},watch:function(e,t,n){return u.$watch(e,t,n)},getState:function(){return JSON.parse(JSON.stringify(l.__state__))},hotUpdate:function(e,t){var n=this,r="string"==typeof e?t:e,o="string"==typeof e?e:"",i=o.split("."),a=l;i.forEach(function(e){a=a[e]}),Object.keys(a.__getters__).forEach(function(e){delete a.__getters__[e]}),Object.keys(a.__methods__).forEach(function(e){delete a.__methods__[e]}),Object.keys(r).forEach(function(e){if(/[A-Z]/.test(e[0]))n.hotUpdate(o+"."+e,r[e]);else{var t=Object.getOwnPropertyDescriptor(r,e).get;"function"==typeof t?a.__getters__[e]=t:"function"==typeof r[e]&&(a.__methods__[e]=r[e])}})}};function p(r,o,i){void 0===o&&(o=[]),"function"==typeof r&&(r=r());var l={},d={},v={},y={},h=o.length?{}:Object.create(f),b={},m=o.join("/");return Object.keys(r).forEach(function(e){if(/[A-Z]/.test(e[0])){if(!r[e])return;var n=p(r[e],o.concat(e));Object.defineProperty(h,e,{value:n,enumerable:!0,configurable:!1}),v[e]=n.__state__,y[e]=n.__stateGetters__}else{var _=Object.getOwnPropertyDescriptor(r,e).get;if("function"==typeof _){d[e]=_,b.computed=b.computed||{},t(b.computed,e,function(){return d[e].call(y)});var s={get:function(){return h.__vue__[e]},enumerable:!0};Object.defineProperty(y,e,s),Object.defineProperty(h,e,s)}else if("function"==typeof r[e])l[e]=r[e],t(h,e,"$"===e[0]?function(t){return c&&u.$emit(c,{actionType:m?m+"/"+e:e,payload:t},v),l[e].call(h,t)}:function(t){c&&u.$emit(c,{type:m?m+"/"+e:e,payload:t},v),a=!0,l[e].call(v,t),a=!1});else{(b.data=b.data||{})[e]=i&&e in i?i[e]:r[e];s={get:function(){return h.__vue__[e]},set:function(t){h.__vue__[e]=t},enumerable:!0};Object.defineProperty(v,e,s),Object.defineProperty(y,e,s),Object.defineProperty(h,e,s)}}}),Object.defineProperties(h,{__vue__:{value:new e(b)},__methods__:{value:l},__getters__:{value:d},__state__:{value:v},__stateGetters__:{value:y}}),s&&h.__vue__.$watch(function(){return v},function(){a||_||setTimeout(function(){n("Only mutation could change state.")})},{deep:!0,sync:!0}),h}var l=p(o);return i&&Array.isArray(i.plugins)&&i.plugins.forEach(function(e){"function"==typeof e&&e(l)}),l}}});
