!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).VueStorePlugin=t()}(this,function(){"use strict";var e,t="vuestore: ";return{install:function(n){e&&e===n&&console.warn(t+"Do not install the plugin again."),(e=n).mixin({beforeCreate:function(){var e=this.$options;e.store?this.$store=e.store:e.parent&&e.parent.$store&&(this.$store=e.parent.$store)}})},createStore:function(n,o){if(!e)throw new Error(t+"Please install VueStorePlugin first.");var r=!1,i=!1,c="",u=new e,a={addModule:function(e,t){var n=e.split("."),o=n.pop(),r=_;return n.forEach(function(e){r=r[e]}),Object.defineProperty(r,o,{value:f(t,n.concat(o))[0],enumerable:!0,configurable:!0}),r[o]},removeModule:function(e){var n=e.split("."),o=n.pop(),r=_;n.forEach(function(e){r=r[e]});try{var i=r[o].__vue__;delete r[o],i.$destroy()}catch(n){throw new Error(t+"Only dynamic module can be removed while "+e+" is an initial module.")}},subscribe:function(e){c||(c="vuestore-mutation-action-subscribe-event");var t=function(t,n){e(t,n)};return u.$on(c,t),function(){u.$off(c,t)}},replaceState:function(e,n){void 0===n&&(n=_),i=!0;var o=n.__vue__;Object.keys(e).forEach(function(r){if(/[A-Z]/.test(r[0])){var i=a.replaceState;if(!n[r])throw new Error(t+"Namespace sub module "+r+" does not exist");i(e[r],n[r])}else{"function"!=typeof Object.getOwnPropertyDescriptor(e,r).get&&"function"!=typeof e[r]&&o.$set(o,r,e[r])}}),i=!1},watch:function(e,t,n){var o=e.bind(d);return u.$watch(o,t,n)},getState:function(){return JSON.parse(JSON.stringify(p))},hotUpdate:function(e,t){var n="string"==typeof e?t:e,o="string"==typeof e?e:"",r=o.split("/"),i=_;r.forEach(function(e){i=i[e]}),Object.keys(i.__module__).forEach(function(e){"function"==typeof i.__module__[e]&&delete i.__module__[e]}),Object.keys(n).forEach(function(e){if(/[A-Z]/.test(e[0])){(0,a.hotUpdate)(o+"/"+e,n[e])}else{var t=Object.getOwnPropertyDescriptor(n,e).get;"function"==typeof t?i.__module__[e]=t:"function"==typeof n[e]&&(i.__module__[e]=n[e])}})}};function f(t,n){void 0===n&&(n=[]),"function"==typeof t&&(t=t());var o={},i=n.length?{}:Object.create(a),s={},l={},p={__state__:s,__stateGetters__:l,data:{}},d=n.join("/");Object.keys(t).forEach(function(e){if(/[A-Z]/.test(e[0])){if(!t[e])return;var a=f(t[e],n.concat(e)),y=a[0],v=a[1],b=a[2];Object.defineProperty(i,e,{value:y,enumerable:!0,configurable:!1}),s[e]=v,l[e]=b}else{var m=Object.getOwnPropertyDescriptor(t,e).get;if("function"==typeof m){o[e]=m,p.computed=p.computed||{},p.computed[e]=function(){return o[e].call(l)};var h={get:function(){return _[e]},enumerable:!0};Object.defineProperty(l,e,h),Object.defineProperty(i,e,h)}else if("function"==typeof t[e])o[e]=t[e],function(e,t,n){var o;e[t]=(o={},o[t]=n,o)[t]}(i,e,"$"===e[0]?function(t){return c&&u.$emit(c,{actionType:d?d+"/"+e:e,payload:t},s),o[e].call(i,t)}:function(t){r=!0,c&&u.$emit(c,{type:d?d+"/"+e:e,payload:t},s),o[e].call(s,t),r=!1});else{p.data[e]=t[e];h={get:function(){return _[e]},set:function(t){_[e]=t},enumerable:!0};Object.defineProperty(s,e,h),Object.defineProperty(l,e,h),Object.defineProperty(i,e,h)}}});var _=new e(p);return Object.defineProperties(i,{__vue__:{value:_},__module__:{value:o}}),[i,s,l]}var s=f(n),l=s[0],p=s[1],d=s[2],_=l;return o&&o.strict&&u.$watch(function(){return p},function(){r||i||setTimeout(function(){throw new Error(t+"Only mutation could change state!")})},{deep:!0,sync:!0}),o&&Array.isArray(o.plugins)&&o.plugins.forEach(function(e){"function"==typeof e&&e(_)}),_}}});
