!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).VueStorePlugin=t()}(this,function(){"use strict";var e,t="vuestore: ";function n(n,o){if(!e)throw new Error(t+"Please install VueStorePlugin first.");var r=!1,i=!1,c="",u=new e,f={addModule:function(e,t){var n=e.split("."),o=n.pop(),r=_;return n.forEach(function(e){r=r[e]}),Object.defineProperty(r,o,{value:a(t,n.concat(o))[0],enumerable:!0,configurable:!0}),r[o]},removeModule:function(e){var n=e.split("."),o=n.pop(),r=_;n.forEach(function(e){r=r[e]});try{var i=r[o].__vue__;delete r[o],i.$destroy()}catch(n){throw new Error(t+"Only dynamic module can be removed while "+e+" is an initial module.")}},subscribe:function(e){c||(c="vuestore-mutation-action-subscribe-event");var t=function(t,n){e(t,n)};return u.$on(c,t),function(){return u.$off(c,t)}},replaceState:function(e,n){void 0===n&&(n=_),i=!0;var o=n.__vue__;Object.keys(e).forEach(function(r){if(/[A-Z]/.test(r[0])){var i=f.replaceState;if(!n[r])throw new Error(t+"Namespace sub module "+r+" does not exist");i(e[r],n[r])}else{"function"!=typeof Object.getOwnPropertyDescriptor(e,r).get&&"function"!=typeof e[r]&&o.$set(o,r,e[r])}}),i=!1},watch:function(e,t,n){var o=e.bind(d);return u.$watch(o,t,n)},getState:function(){return JSON.parse(JSON.stringify(p))},hotUpdate:function(e,t){var n="string"==typeof e?t:e,o="string"==typeof e?e:"",r=o.split("/"),i=_;r.forEach(function(e){i=i[e]}),Object.keys(i.__module__).forEach(function(e){"function"==typeof i.__module__[e]&&delete i.__module__[e]}),Object.keys(n).forEach(function(e){if(/[A-Z]/.test(e[0])){(0,f.hotUpdate)(o+"/"+e,n[e])}else{var t=Object.getOwnPropertyDescriptor(n,e).get;"function"==typeof t?i.__module__[e]=t:"function"==typeof n[e]&&(i.__module__[e]=n[e])}})}};function a(t,n){void 0===n&&(n=[]);var o=n.length?{}:Object.create(f),i={},s={},l={__state__:i,__stateGetters__:s,data:{}},p=n.join("/");Object.keys(t).forEach(function(e){if(/[A-Z]/.test(e[0])){if(!t[e])return;var f=a(t[e],n.concat(e)),_=f[0],y=f[1],b=f[2];Object.defineProperty(o,e,{value:_,enumerable:!0,configurable:!1}),i[e]=y,s[e]=b}else{var v=Object.getOwnPropertyDescriptor(t,e).get;if("function"==typeof v){delete t[e],t[e]=v,l.computed=l.computed||{},l.computed[e]=function(){return t[e].call(s)};var m={get:function(){return d[e]},enumerable:!0};Object.defineProperty(s,e,m),Object.defineProperty(o,e,m)}else if("function"==typeof t[e])l.methods=l.methods||{},"$"===e[0]?o[e]=function(n){return c&&u.$emit(c,{actionType:p?p+"/"+e:e,payload:n},i),t[e].call(o,n)}:o[e]=function(n){r=!0,c&&u.$emit(c,{type:p?p+"/"+e:e,payload:n},i),t[e].call(i,n),r=!1};else{l.data[e]=t[e];m={get:function(){return d[e]},set:function(t){d[e]=t},enumerable:!0};Object.defineProperty(i,e,m),Object.defineProperty(s,e,m),Object.defineProperty(o,e,m)}}});var d=new e(l);return Object.defineProperty(o,"__vue__",{value:d}),Object.defineProperty(o,"__module__",{value:t}),[o,i,s]}var s=a(n),l=s[0],p=s[1],d=s[2],_=l;return o&&o.strict&&u.$watch(function(){return p},function(){r||i||setTimeout(function(){throw new Error(t+"Only mutation could change state!")})},{deep:!0,sync:!0}),o&&Array.isArray(o.plugins)&&o.plugins.forEach(function(e){"function"==typeof e&&e(_)}),_}return function(){function o(){}return o.install=function(n){e&&e===n&&console.warn(t+"Do not install the plugin again."),(e=n).mixin({beforeCreate:function(){var e=this.$options;e.store?this.$store=e.store:e.parent&&e.parent.$store&&(this.$store=e.parent.$store)}})},o.createStore=n,o}()});
